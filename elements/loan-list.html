<link rel="import" href="/bower_components/polymer/polymer.html">

<link rel="import" href="/bower_components/iron-selector/iron-selector.html">

<link rel="import" href="/elements/loan-list-item.html">

<dom-module id="loan-list">
  <template>
    <template is='dom-repeat' id="loanList" items="[[loans]]">
      <loan-list-item on-selected-changed="_selectedChanged" selected="[[_isLoanSelected(selectedLoans.*, item)]]" loan="[[item]]">
      </loan-list-item>
    </template>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'loan-list',
    properties: {
      loans: {
        type: Object,
        value: []
      },
      selectedLoans: {
        type: Object,
        notify: true,
        value: []
      }
    },
    _selectedChanged: function(e) {
      if (e.detail.value) {
        this.push('selectedLoans', e.model.item);
      } else {
        this._removeSelectedLoan(e.model.item);
      }
    },
    _isLoanSelected: function(selectedLoans, loan) {
      return this.selectedLoans.indexOf(loan) != -1;
    },
    _removeSelectedLoan: function(loan) {
      var index = this.selectedLoans.indexOf(loan);
      if (index != -1) {
        this.splice('selectedLoans', index, 1);
      }
    }
  });
</script>
